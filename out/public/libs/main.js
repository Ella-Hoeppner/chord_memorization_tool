/*! For license information please see main.js.LICENSE.txt */
(()=>{var t,e,s,i,r,a={392:(t,e,s)=>{"use strict";s.r(e),s.d(e,{FaustAudioWorkletNode:()=>Z,FaustBaseWebAudioDsp:()=>z,FaustCompiler:()=>V,FaustDspInstance:()=>E,FaustMonoAudioWorkletNode:()=>X,FaustMonoDspGenerator:()=>it,FaustMonoOfflineProcessor:()=>B,FaustMonoScriptProcessorNode:()=>tt,FaustMonoWebAudioDsp:()=>T,FaustOfflineProcessor:()=>L,FaustPolyAudioWorkletNode:()=>Y,FaustPolyDspGenerator:()=>at,FaustPolyOfflineProcessor:()=>U,FaustPolyScriptProcessorNode:()=>et,FaustPolyWebAudioDsp:()=>W,FaustScriptProcessorNode:()=>Q,FaustSvgDiagrams:()=>$,FaustWasmInstantiator:()=>k,FaustWebAudioDspVoice:()=>j,LibFaust:()=>J,WavDecoder:()=>q,WavEncoder:()=>K,ab2str:()=>F,getFaustAudioWorkletProcessor:()=>M,getFaustFFTAudioWorkletProcessor:()=>C,instantiateFaustModuleFromFile:()=>D,str2ab:()=>N});var i,r,a=Object.create,n=Object.defineProperty,o=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames,u=Object.getPrototypeOf,h=Object.prototype.hasOwnProperty,l=(t,e)=>function(){return e||(0,t[f(t)[0]])((e={exports:{}}).exports,e),e.exports},c=l({"node_modules/tslib/tslib.js"(t,e){var s,i,r,a,n,o,f,u,h,l,c,p,d,m,g,y,S,P,b,w,O,v,I;!function(t){var s="object"==typeof global?global:"object"==typeof self?self:"object"==typeof this?this:{};function i(t,e){return t!==s&&("function"==typeof Object.create?Object.defineProperty(t,"__esModule",{value:!0}):t.__esModule=!0),function(s,i){return t[s]=e?e(s,i):i}}"function"==typeof define&&define.amd?define("tslib",["exports"],(function(e){t(i(s,i(e)))})):"object"==typeof e&&"object"==typeof e.exports?t(i(s,i(e.exports))):t(i(s))}((function(t){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s])};s=function(t,s){function i(){this.constructor=t}e(t,s),t.prototype=null===s?Object.create(s):(i.prototype=s.prototype,new i)},i=Object.assign||function(t){for(var e,s=1,i=arguments.length;s<i;s++)for(var r in e=arguments[s])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},r=function(t,e){var s={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(s[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(s[i[r]]=t[i[r]])}return s},a=function(t,e,s,i){var r,a=arguments.length,n=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,s,i);else for(var o=t.length-1;o>=0;o--)(r=t[o])&&(n=(a<3?r(n):a>3?r(e,s,n):r(e,s))||n);return a>3&&n&&Object.defineProperty(e,s,n),n},n=function(t,e){return function(s,i){e(s,i,t)}},o=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},f=function(t,e,s,i){return new(s||(s=Promise))((function(r,a){function n(t){try{f(i.next(t))}catch(t){a(t)}}function o(t){try{f(i.throw(t))}catch(t){a(t)}}function f(t){var e;t.done?r(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(n,o)}f((i=i.apply(t,e||[])).next())}))},u=function(t,e){var s,i,r,a,n={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(s)throw new TypeError("Generator is already executing.");for(;n;)try{if(s=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return n.label++,{value:a[1],done:!1};case 5:n.label++,i=a[1],a=[0];continue;case 7:a=n.ops.pop(),n.trys.pop();continue;default:if(!((r=(r=n.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){n=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){n.label=a[1];break}if(6===a[0]&&n.label<r[1]){n.label=r[1],r=a;break}if(r&&n.label<r[2]){n.label=r[2],n.ops.push(a);break}r[2]&&n.ops.pop(),n.trys.pop();continue}a=e.call(t,n)}catch(t){a=[6,t],i=0}finally{s=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}},I=function(t,e,s,i){void 0===i&&(i=s),t[i]=e[s]},h=function(t,e){for(var s in t)"default"===s||e.hasOwnProperty(s)||(e[s]=t[s])},l=function(t){var e="function"==typeof Symbol&&Symbol.iterator,s=e&&t[e],i=0;if(s)return s.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},c=function(t,e){var s="function"==typeof Symbol&&t[Symbol.iterator];if(!s)return t;var i,r,a=s.call(t),n=[];try{for(;(void 0===e||e-- >0)&&!(i=a.next()).done;)n.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(s=a.return)&&s.call(a)}finally{if(r)throw r.error}}return n},p=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(c(arguments[e]));return t},d=function(){for(var t=0,e=0,s=arguments.length;e<s;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<s;e++)for(var a=arguments[e],n=0,o=a.length;n<o;n++,r++)i[r]=a[n];return i},m=function(t){return this instanceof m?(this.v=t,this):new m(t)},g=function(t,e,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=s.apply(t,e||[]),a=[];return i={},n("next"),n("throw"),n("return"),i[Symbol.asyncIterator]=function(){return this},i;function n(t){r[t]&&(i[t]=function(e){return new Promise((function(s,i){a.push([t,e,s,i])>1||o(t,e)}))})}function o(t,e){try{(s=r[t](e)).value instanceof m?Promise.resolve(s.value.v).then(f,u):h(a[0][2],s)}catch(t){h(a[0][3],t)}var s}function f(t){o("next",t)}function u(t){o("throw",t)}function h(t,e){t(e),a.shift(),a.length&&o(a[0][0],a[0][1])}},y=function(t){var e,s;return e={},i("next"),i("throw",(function(t){throw t})),i("return"),e[Symbol.iterator]=function(){return this},e;function i(i,r){e[i]=t[i]?function(e){return(s=!s)?{value:m(t[i](e)),done:"return"===i}:r?r(e):e}:r}},S=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,s=t[Symbol.asyncIterator];return s?s.call(t):(t=l(t),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(s){e[s]=t[s]&&function(e){return new Promise((function(i,r){!function(t,e,s,i){Promise.resolve(i).then((function(e){t({value:e,done:s})}),e)}(i,r,(e=t[s](e)).done,e.value)}))}}},P=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},b=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var s in t)Object.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e.default=t,e},w=function(t){return t&&t.__esModule?t:{default:t}},O=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)},v=function(t,e,s){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,s),s},t("__extends",s),t("__assign",i),t("__rest",r),t("__decorate",a),t("__param",n),t("__metadata",o),t("__awaiter",f),t("__generator",u),t("__exportStar",h),t("__createBinding",I),t("__values",l),t("__read",c),t("__spread",p),t("__spreadArrays",d),t("__await",m),t("__asyncGenerator",g),t("__asyncDelegator",y),t("__asyncValues",S),t("__makeTemplateObject",P),t("__importStar",b),t("__importDefault",w),t("__classPrivateFieldGet",O),t("__classPrivateFieldSet",v)}))}}),p=l({"node_modules/@aws-crypto/sha256-js/build/constants.js"(t){Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_HASHABLE_LENGTH=t.INIT=t.KEY=t.DIGEST_LENGTH=t.BLOCK_SIZE=void 0,t.BLOCK_SIZE=64,t.DIGEST_LENGTH=32,t.KEY=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),t.INIT=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],t.MAX_HASHABLE_LENGTH=Math.pow(2,53)-1}}),d=l({"node_modules/@aws-crypto/sha256-js/build/RawSha256.js"(t){Object.defineProperty(t,"__esModule",{value:!0}),t.RawSha256=void 0;var e=p(),s=function(){function t(){this.state=Int32Array.from(e.INIT),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return t.prototype.update=function(t){if(this.finished)throw new Error("Attempted to update an already finished hash.");var s=0,i=t.byteLength;if(this.bytesHashed+=i,8*this.bytesHashed>e.MAX_HASHABLE_LENGTH)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;i>0;)this.buffer[this.bufferLength++]=t[s++],i--,this.bufferLength===e.BLOCK_SIZE&&(this.hashBuffer(),this.bufferLength=0)},t.prototype.digest=function(){if(!this.finished){var t=8*this.bytesHashed,s=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),i=this.bufferLength;if(s.setUint8(this.bufferLength++,128),i%e.BLOCK_SIZE>=e.BLOCK_SIZE-8){for(var r=this.bufferLength;r<e.BLOCK_SIZE;r++)s.setUint8(r,0);this.hashBuffer(),this.bufferLength=0}for(r=this.bufferLength;r<e.BLOCK_SIZE-8;r++)s.setUint8(r,0);s.setUint32(e.BLOCK_SIZE-8,Math.floor(t/4294967296),!0),s.setUint32(e.BLOCK_SIZE-4,t),this.hashBuffer(),this.finished=!0}var a=new Uint8Array(e.DIGEST_LENGTH);for(r=0;r<8;r++)a[4*r]=this.state[r]>>>24&255,a[4*r+1]=this.state[r]>>>16&255,a[4*r+2]=this.state[r]>>>8&255,a[4*r+3]=this.state[r]>>>0&255;return a},t.prototype.hashBuffer=function(){for(var t=this.buffer,s=this.state,i=s[0],r=s[1],a=s[2],n=s[3],o=s[4],f=s[5],u=s[6],h=s[7],l=0;l<e.BLOCK_SIZE;l++){if(l<16)this.temp[l]=(255&t[4*l])<<24|(255&t[4*l+1])<<16|(255&t[4*l+2])<<8|255&t[4*l+3];else{var c=this.temp[l-2],p=(c>>>17|c<<15)^(c>>>19|c<<13)^c>>>10,d=((c=this.temp[l-15])>>>7|c<<25)^(c>>>18|c<<14)^c>>>3;this.temp[l]=(p+this.temp[l-7]|0)+(d+this.temp[l-16]|0)}var m=(((o>>>6|o<<26)^(o>>>11|o<<21)^(o>>>25|o<<7))+(o&f^~o&u)|0)+(h+(e.KEY[l]+this.temp[l]|0)|0)|0,g=((i>>>2|i<<30)^(i>>>13|i<<19)^(i>>>22|i<<10))+(i&r^i&a^r&a)|0;h=u,u=f,f=o,o=n+m|0,n=a,a=r,r=i,i=m+g|0}s[0]+=i,s[1]+=r,s[2]+=a,s[3]+=n,s[4]+=o,s[5]+=f,s[6]+=u,s[7]+=h},t}();t.RawSha256=s}}),m=l({"node_modules/@aws-sdk/util-utf8-browser/dist-cjs/pureJs.js"(t){Object.defineProperty(t,"__esModule",{value:!0}),t.toUtf8=t.fromUtf8=void 0,t.fromUtf8=t=>{const e=[];for(let s=0,i=t.length;s<i;s++){const i=t.charCodeAt(s);if(i<128)e.push(i);else if(i<2048)e.push(i>>6|192,63&i|128);else if(s+1<t.length&&55296==(64512&i)&&56320==(64512&t.charCodeAt(s+1))){const r=65536+((1023&i)<<10)+(1023&t.charCodeAt(++s));e.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}else e.push(i>>12|224,i>>6&63|128,63&i|128)}return Uint8Array.from(e)},t.toUtf8=t=>{let e="";for(let s=0,i=t.length;s<i;s++){const i=t[s];if(i<128)e+=String.fromCharCode(i);else if(192<=i&&i<224){const r=t[++s];e+=String.fromCharCode((31&i)<<6|63&r)}else if(240<=i&&i<365){const r="%"+[i,t[++s],t[++s],t[++s]].map((t=>t.toString(16))).join("%");e+=decodeURIComponent(r)}else e+=String.fromCharCode((15&i)<<12|(63&t[++s])<<6|63&t[++s])}return e}}}),g=l({"node_modules/@aws-sdk/util-utf8-browser/dist-cjs/whatwgEncodingApi.js"(t){Object.defineProperty(t,"__esModule",{value:!0}),t.toUtf8=t.fromUtf8=void 0,t.fromUtf8=function(t){return(new TextEncoder).encode(t)},t.toUtf8=function(t){return new TextDecoder("utf-8").decode(t)}}}),y=l({"node_modules/@aws-sdk/util-utf8-browser/dist-cjs/index.js"(t){Object.defineProperty(t,"__esModule",{value:!0}),t.toUtf8=t.fromUtf8=void 0;var e=m(),s=g();t.fromUtf8=t=>"function"==typeof TextEncoder?(0,s.fromUtf8)(t):(0,e.fromUtf8)(t),t.toUtf8=t=>"function"==typeof TextDecoder?(0,s.toUtf8)(t):(0,e.toUtf8)(t)}}),S=l({"node_modules/@aws-crypto/util/build/convertToBuffer.js"(t){Object.defineProperty(t,"__esModule",{value:!0}),t.convertToBuffer=void 0;var e=y(),s="undefined"!=typeof Buffer&&Buffer.from?function(t){return Buffer.from(t,"utf8")}:e.fromUtf8;t.convertToBuffer=function(t){return t instanceof Uint8Array?t:"string"==typeof t?s(t):ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(t)}}}),P=l({"node_modules/@aws-crypto/util/build/isEmptyData.js"(t){Object.defineProperty(t,"__esModule",{value:!0}),t.isEmptyData=void 0,t.isEmptyData=function(t){return"string"==typeof t?0===t.length:0===t.byteLength}}}),b=l({"node_modules/@aws-crypto/util/build/numToUint8.js"(t){Object.defineProperty(t,"__esModule",{value:!0}),t.numToUint8=void 0,t.numToUint8=function(t){return new Uint8Array([(4278190080&t)>>24,(16711680&t)>>16,(65280&t)>>8,255&t])}}}),w=l({"node_modules/@aws-crypto/util/build/uint32ArrayFrom.js"(t){Object.defineProperty(t,"__esModule",{value:!0}),t.uint32ArrayFrom=void 0,t.uint32ArrayFrom=function(t){if(!Uint32Array.from){for(var e=new Uint32Array(t.length),s=0;s<t.length;)e[s]=t[s],s+=1;return e}return Uint32Array.from(t)}}}),O=l({"node_modules/@aws-crypto/util/build/index.js"(t){Object.defineProperty(t,"__esModule",{value:!0}),t.uint32ArrayFrom=t.numToUint8=t.isEmptyData=t.convertToBuffer=void 0;var e=S();Object.defineProperty(t,"convertToBuffer",{enumerable:!0,get:function(){return e.convertToBuffer}});var s=P();Object.defineProperty(t,"isEmptyData",{enumerable:!0,get:function(){return s.isEmptyData}});var i=b();Object.defineProperty(t,"numToUint8",{enumerable:!0,get:function(){return i.numToUint8}});var r=w();Object.defineProperty(t,"uint32ArrayFrom",{enumerable:!0,get:function(){return r.uint32ArrayFrom}})}}),v=l({"node_modules/@aws-crypto/sha256-js/build/jsSha256.js"(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Sha256=void 0;var e=c(),s=p(),i=d(),r=O(),a=function(){function t(t){if(this.hash=new i.RawSha256,t){this.outer=new i.RawSha256;var e=function(t){var e=(0,r.convertToBuffer)(t);if(e.byteLength>s.BLOCK_SIZE){var a=new i.RawSha256;a.update(e),e=a.digest()}var n=new Uint8Array(s.BLOCK_SIZE);return n.set(e),n}(t),a=new Uint8Array(s.BLOCK_SIZE);a.set(e);for(var n=0;n<s.BLOCK_SIZE;n++)e[n]^=54,a[n]^=92;for(this.hash.update(e),this.outer.update(a),n=0;n<e.byteLength;n++)e[n]=0}}return t.prototype.update=function(t){if(!(0,r.isEmptyData)(t)&&!this.error)try{this.hash.update((0,r.convertToBuffer)(t))}catch(t){this.error=t}},t.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},t.prototype.digest=function(){return e.__awaiter(this,void 0,void 0,(function(){return e.__generator(this,(function(t){return[2,this.digestSync()]}))}))},t}();t.Sha256=a}}),I=l({"node_modules/@aws-crypto/sha256-js/build/index.js"(t){Object.defineProperty(t,"__esModule",{value:!0}),c().__exportStar(v(),t)}}),D=async(t,e=t.replace(/c?js$/,"data"),i=t.replace(/c?js$/,"wasm"))=>{var r,a;let n,o,f;const u=/var (.+) = \(/;if("object"==typeof window){let s=await(await fetch(t)).text();s=`${s}\nexport default ${null==(r=s.match(u))?void 0:r[1]};\n`;const a=URL.createObjectURL(new Blob([s],{type:"text/javascript"}));n=(await import(a)).default,o=await(await fetch(e)).arrayBuffer(),f=new Uint8Array(await(await fetch(i)).arrayBuffer())}else{const{promises:r}=await s.e(282).then(s.t.bind(s,282,19)),{pathToFileURL:h}=await Promise.all([s.e(575),s.e(654)]).then(s.t.bind(s,575,19));let l=await r.readFile(t,{encoding:"utf-8"});l=`\nimport process from "process";\nimport * as path from "path";\nimport { createRequire } from "module";\nimport { fileURLToPath } from "url";\n\nconst __dirname = path.dirname(fileURLToPath(import.meta.url));\nconst __filename = fileURLToPath(import.meta.url);\nconst require = createRequire(import.meta.url);\n\n${l}\n\nexport default ${null==(a=l.match(u))?void 0:a[1]};\n`;const c=t.replace(/c?js$/,"mjs");await r.writeFile(c,l),n=(await import(h(c).href)).default,await r.unlink(c),o=(await r.readFile(e)).buffer,f=(await r.readFile(i)).buffer}return await n({wasmBinary:f,getPreloadedPackage:(t,e)=>"libfaust-wasm.data"===t?o:new ArrayBuffer(0)})},M=(t,e,s=!0)=>{const{registerProcessor:i,AudioWorkletProcessor:r,sampleRate:a}=globalThis,{FaustBaseWebAudioDsp:n,FaustWasmInstantiator:o}=t,{processorName:f,dspName:u,dspMeta:h,effectMeta:l,poly:c}=e;class p extends r{constructor(t){super(t),this.paramValuesCache={},this.port.onmessage=t=>this.handleMessageAux(t);const{parameterDescriptors:e}=this.constructor;e.forEach((t=>{this.paramValuesCache[t.name]=t.defaultValue||0}))}static get parameterDescriptors(){const t=[],e=e=>{const s=(t=>{const e="address"in t&&!!["/gate","/freq","/gain","/key","/vel","/velocity"].find((e=>t.address.endsWith(e)));return c&&e?null:"vslider"===t.type||"hslider"===t.type||"nentry"===t.type?{name:t.address,defaultValue:t.init||0,minValue:t.min||0,maxValue:t.max||0}:"button"===t.type||"checkbox"===t.type?{name:t.address,defaultValue:t.init||0,minValue:0,maxValue:1}:null})(e);s&&t.push(s)};return n.parseUI(h.ui,e),l&&n.parseUI(l.ui,e),t}process(t,e,s){for(const t in s){const[e]=s[t];e!==this.paramValuesCache[t]&&(this.fDSPCode.setParamValue(t,e),this.paramValuesCache[t]=e)}return this.fDSPCode.compute(t[0],e[0])}handleMessageAux(t){const e=t.data;switch(e.type){case"midi":this.midiMessage(e.data);break;case"ctrlChange":this.ctrlChange(e.data[0],e.data[1],e.data[2]);break;case"pitchWheel":this.pitchWheel(e.data[0],e.data[1]);break;case"param":this.setParamValue(e.data.path,e.data.value);break;case"setPlotHandler":e.data?this.fDSPCode.setPlotHandler(((t,e,s)=>this.port.postMessage({type:"plot",value:t,index:e,events:s}))):this.fDSPCode.setPlotHandler(null);break;case"start":this.fDSPCode.start();break;case"stop":this.fDSPCode.stop();break;case"destroy":this.port.close(),this.fDSPCode.destroy()}}setParamValue(t,e){this.fDSPCode.setParamValue(t,e),this.paramValuesCache[t]=e}midiMessage(t){this.fDSPCode.midiMessage(t)}ctrlChange(t,e,s){this.fDSPCode.ctrlChange(t,e,s)}pitchWheel(t,e){this.fDSPCode.pitchWheel(t,e)}}class d extends p{constructor(e){super(e);const{FaustMonoWebAudioDsp:s}=t,{factory:i,sampleSize:r}=e.processorOptions,n=o.createSyncMonoDSPInstance(i);this.fDSPCode=new s(n,a,r,128),this.fDSPCode.setOutputParamHandler(((t,e)=>this.port.postMessage({path:t,value:e,type:"param"}))),this.fDSPCode.start()}}class m extends p{constructor(e){super(e),this.handleMessageAux=t=>{const e=t.data;switch(e.type){case"keyOn":this.keyOn(e.data[0],e.data[1],e.data[2]);break;case"keyOff":this.keyOff(e.data[0],e.data[1],e.data[2]);break;default:super.handleMessageAux(t)}};const{FaustPolyWebAudioDsp:s}=t,{voiceFactory:i,mixerModule:r,voices:n,effectFactory:f,sampleSize:u}=e.processorOptions,h=o.createSyncPolyDSPInstance(i,r,n,f);this.fDSPCode=new s(h,a,u,128),this.port.onmessage=t=>this.handleMessageAux(t),this.fDSPCode.setOutputParamHandler(((t,e)=>this.port.postMessage({path:t,value:e,type:"param"}))),this.fDSPCode.start()}midiMessage(t){const e=t[0]>>4,s=15&t[0],i=t[1],r=t[2];8===e||9===e&&0===r?this.keyOff(s,i,r):9===e?this.keyOn(s,i,r):super.midiMessage(t)}keyOn(t,e,s){this.fDSPCode.keyOn(t,e,s)}keyOff(t,e,s){this.fDSPCode.keyOff(t,e,s)}allNotesOff(t){this.fDSPCode.allNotesOff(t)}}const g=c?m:d;if(s)try{i(f||u||(c?"mydsp_poly":"mydsp"),g)}catch(t){console.warn(t)}return c?m:d},C=(t,e,s=!0)=>{const{registerProcessor:i,AudioWorkletProcessor:r,sampleRate:a}=globalThis,{FaustBaseWebAudioDsp:n,FaustWasmInstantiator:o,FaustMonoWebAudioDsp:f,FFTUtils:u}=t,{processorName:h,dspName:l,dspMeta:c,fftOptions:p}=e,{windowFunctions:d,getFFT:m,fftToSignal:g,signalToFFT:y,signalToNoFFT:S}=u,P=(t,e)=>(t%e+e)%e,b=["/fftSize","/fftHopSize","/fftOverlap","/windowFunction","/noIFFT"],w=(t,e,s=0,i=0)=>{const r=t.length,a=e.length,n=Math.min(r,a);let o=0,f=P(s,r)||0,u=P(i,a)||0;for(;o<n;){const s=Math.min(n-o,r-f,a-u),i=u+s;0===u&&i===a?t.set(e,f):t.set(e.subarray(u,i),f),f=(f+s)%r,u=i%a,o+=s}return f};class O extends r{constructor(t){super(t),this.paramValuesCache={},this.destroyed=!1,this.$inputWrite=0,this.$inputRead=0,this.$outputWrite=0,this.$outputRead=0,this.noIFFT=!1,this.fftInput=[],this.fftOutput=[],this.fftOverlap=0,this.fftHopSize=0,this.fftSize=0,this.fftBufferSize=0,this.fPlotHandler=null,this.fCachedEvents=[],this.fBufferNum=0,this.windowFunction=null,this.port.onmessage=t=>this.handleMessageAux(t);const{parameterDescriptors:e}=this.constructor;e.forEach((t=>{this.paramValuesCache[t.name]=t.defaultValue||0}));const{factory:s,sampleSize:i}=t.processorOptions;this.dspInstance=o.createSyncMonoDSPInstance(s),this.sampleSize=i,this.initFFT()}get fftProcessorBufferSize(){return this.fftSize/2+1}async initFFT(){return this.FFT=await m(),await this.createFFTProcessor(),!0}static get parameterDescriptors(){const t=[];return n.parseUI(c.ui,(e=>{const s=(t=>"address"in t&&b.find((e=>t.address.endsWith(e)))?null:"vslider"===t.type||"hslider"===t.type||"nentry"===t.type?{name:t.address,defaultValue:t.init||0,minValue:t.min||0,maxValue:t.max||0}:"button"===t.type||"checkbox"===t.type?{name:t.address,defaultValue:t.init||0,minValue:0,maxValue:1}:null)(e);s&&t.push(s)})),[...t,{defaultValue:(null==p?void 0:p.fftSize)||1024,maxValue:2**32,minValue:2,name:"fftSize"},{defaultValue:(null==p?void 0:p.fftOverlap)||2,maxValue:32,minValue:1,name:"fftOverlap"},{defaultValue:"number"==typeof(null==p?void 0:p.defaultWindowFunction)?p.defaultWindowFunction+1:0,maxValue:(null==d?void 0:d.length)||0,minValue:0,name:"windowFunction"},{defaultValue:+!!(null==p?void 0:p.noIFFT)||0,maxValue:1,minValue:0,name:"noIFFT"}]}processFFT(){let t=P(this.$inputWrite-this.$inputRead,this.fftBufferSize)||this.fftBufferSize;for(;t>=this.fftSize;){let e=[];this.fDSPCode.compute((t=>{for(let e=0;e<Math.min(this.fftInput.length,Math.ceil(t.length/3));e++){const s=this.rfft.forward((t=>{w(t,this.fftInput[e],0,this.$inputRead);for(let e=0;e<t.length;e++)t[e]*=this.window[e]}));g(s,t[3*e],t[3*e+1],t[3*e+2])}for(let e=3*this.fftInput.length;e<t.length;e++)e%3==2?t[e].forEach(((s,i)=>t[e][i]=i)):t[e].fill(0)}),(t=>{e=t})),this.$inputRead+=this.fftHopSize,this.$inputRead%=this.fftBufferSize,t-=this.fftHopSize;for(let t=0;t<this.fftOutput.length;t++){let s,i;this.noIFFT?(s=this.noIFFTBuffer,S(e[2*t]||this.fftProcessorZeros,e[2*t+1]||this.fftProcessorZeros,s)):s=this.rfft.inverse((s=>{y(e[2*t]||this.fftProcessorZeros,e[2*t+1]||this.fftProcessorZeros,s)}));for(let t=0;t<s.length;t++)s[t]*=this.window[t];for(let e=0;e<s.length-this.fftHopSize;e++)i=P(this.$outputWrite+e,this.fftBufferSize),this.fftOutput[t][i]+=s[e],0===t&&(this.windowSumSquare[i]+=this.noIFFT?this.window[e]:this.window[e]**2);for(let e=s.length-this.fftHopSize;e<s.length;e++)i=P(this.$outputWrite+e,this.fftBufferSize),this.fftOutput[t][i]=s[e],0===t&&(this.windowSumSquare[i]=this.noIFFT?this.window[e]:this.window[e]**2)}this.$outputWrite+=this.fftHopSize,this.$outputWrite%=this.fftBufferSize}}process(t,e,s){if(this.destroyed)return!1;if(!this.FFT)return!0;const i=t[0],r=e[0],a=(null==i?void 0:i.length)||0,n=(null==r?void 0:r.length)||0,o=(null==i?void 0:i.length)&&Math.max(...i.map((t=>t.length)))||128;if(this.noIFFT=!!s.noIFFT[0],this.resetFFT(~~s.fftSize[0],~~s.fftOverlap[0],~~s.windowFunction[0],a,n,o),!this.fDSPCode)return!0;for(const t in s){if(b.find((e=>`/${t}`.endsWith(e))))continue;const[e]=s[t];e!==this.paramValuesCache[t]&&(this.fDSPCode.setParamValue(t,e),this.paramValuesCache[t]=e)}if(null==i?void 0:i.length){let t=0;for(let e=0;e<i.length;e++){const s=this.fftInput[e],r=i[e].length?i[e]:new Float32Array(o);t=w(s,r,this.$inputWrite)}this.$inputWrite=t}else this.$inputWrite+=o,this.$inputWrite%=this.fftBufferSize;this.processFFT();for(let t=0;t<r.length;t++){w(r[t],this.fftOutput[t],0,this.$outputRead);let e=0;for(let s=0;s<o;s++)e=this.windowSumSquare[P(this.$outputRead+s,this.fftBufferSize)],r[t][s]/=e<1e-8?1:e}return this.$outputRead+=o,this.$outputRead%=this.fftBufferSize,this.fPlotHandler&&(this.port.postMessage({type:"plot",value:r,index:this.fBufferNum++,events:this.fCachedEvents}),this.fCachedEvents=[]),!0}handleMessageAux(t){var e,s,i;const r=t.data;switch(r.type){case"midi":this.midiMessage(r.data);break;case"ctrlChange":this.ctrlChange(r.data[0],r.data[1],r.data[2]);break;case"pitchWheel":this.pitchWheel(r.data[0],r.data[1]);break;case"param":this.setParamValue(r.data.path,r.data.value);break;case"setPlotHandler":r.data?this.fPlotHandler=(t,e,s)=>{s&&this.fCachedEvents.push(...s)}:this.fPlotHandler=null,null==(e=this.fDSPCode)||e.setPlotHandler(this.fPlotHandler);break;case"start":null==(s=this.fDSPCode)||s.start();break;case"stop":null==(i=this.fDSPCode)||i.stop();break;case"destroy":this.port.close(),this.destroy()}}setParamValue(t,e){var s;null==(s=this.fDSPCode)||s.setParamValue(t,e),this.paramValuesCache[t]=e}midiMessage(t){var e;null==(e=this.fDSPCode)||e.midiMessage(t)}ctrlChange(t,e,s){var i;null==(i=this.fDSPCode)||i.ctrlChange(t,e,s)}pitchWheel(t,e){var s;null==(s=this.fDSPCode)||s.pitchWheel(t,e)}resetFFT(t,e,s,i,r,a){var n,o;const f=(u=Math.max(2,t||1024),2,~~(Math.abs(2)<1?Math.ceil(.5*u)/.5:2*Math.ceil(u/2)));var u;const h=~~Math.min(f,Math.max(1,e)),l=~~Math.max(1,f/h),c=f-Math.min(l,a);let p=null;0!==s&&(p="object"==typeof d&&d[~~s-1]||null);const m=f!==this.fftSize,g=h!==this.fftOverlap;if((m||g)&&(this.fftSize=f,this.fftOverlap=h,this.fftHopSize=l,this.$inputWrite=0,this.$inputRead=0,this.$outputWrite=0,this.$outputRead=-c,this.fftBufferSize=Math.max(2*f-this.fftHopSize,2*a),!m&&this.fftHopSizeParam&&(null==(n=this.fDSPCode)||n.setParamValue(this.fftHopSizeParam,this.fftHopSize))),m&&(null==(o=this.rfft)||o.dispose(),this.rfft=new this.FFT(f),this.noIFFTBuffer=new Float32Array(this.fftSize),this.createFFTProcessor()),(m||g||p!==this.windowFunction)&&(this.windowFunction=p,this.window=new Float32Array(f),this.window.fill(1),p&&((t,e)=>{for(let s=0;s<t.length;s++)t[s]*=e(s,t.length)})(this.window,p),this.windowSumSquare=new Float32Array(this.fftBufferSize)),this.fftInput.length>i&&this.fftInput.splice(i),this.fftOutput.length>r&&this.fftOutput.splice(r),m||g){for(let t=0;t<i;t++)this.fftInput[t]=new Float32Array(this.fftBufferSize);for(let t=0;t<r;t++)this.fftOutput[t]=new Float32Array(this.fftBufferSize)}else{if(this.fftInput.length<i)for(let t=this.fftInput.length;t<i;t++)this.fftInput[t]=new Float32Array(this.fftBufferSize);if(this.fftOutput.length<r)for(let t=this.fftOutput.length;t<r;t++)this.fftOutput[t]=new Float32Array(this.fftBufferSize)}}async createFFTProcessor(){var t,e;null==(t=this.fDSPCode)||t.stop(),null==(e=this.fDSPCode)||e.destroy(),this.fDSPCode=new f(this.dspInstance,a,this.sampleSize,this.fftProcessorBufferSize),this.fDSPCode.setOutputParamHandler(((t,e)=>this.port.postMessage({path:t,value:e,type:"param"}))),this.fDSPCode.setPlotHandler(this.fPlotHandler);const s=this.fDSPCode.getParams();this.fDSPCode.start();for(const t in this.paramValuesCache)b.find((e=>`/${t}`.endsWith(e)))||this.fDSPCode.setParamValue(t,this.paramValuesCache[t]);const i=s.find((t=>t.endsWith("/fftSize")));i&&this.fDSPCode.setParamValue(i,this.fftSize),this.fftHopSizeParam=s.find((t=>t.endsWith("/fftHopSize"))),this.fftHopSizeParam&&this.fDSPCode.setParamValue(this.fftHopSizeParam,this.fftHopSize),this.fftProcessorZeros=new Float32Array(this.fftProcessorBufferSize)}destroy(){var t,e,s;null==(t=this.fDSPCode)||t.stop(),null==(e=this.fDSPCode)||e.destroy(),null==(s=this.rfft)||s.dispose(),this.destroyed=!0}}const v=O;if(s)try{i(h||l||"myfftdsp",v)}catch(t){console.warn(t)}return O},A=(1,r=null!=(i=I())?a(u(i)):{},((t,e,s,i)=>{if(e&&"object"==typeof e||"function"==typeof e)for(let s of f(e))h.call(t,s)||undefined===s||n(t,s,{get:()=>e[s],enumerable:!(i=o(e,s))||i.enumerable});return t})(n(r,"default",{value:i,enumerable:!0}),i)),F=t=>String.fromCharCode.apply(null,t),N=t=>{const e=new ArrayBuffer(t.length),s=new Uint8Array(e);for(let e=0,i=t.length;e<i;e++)s[e]=t.charCodeAt(e);return s},_=class{static serializeDSPFactories(){const t={};return this.gFactories.forEach(((e,s)=>{const{code:i,json:r,poly:a}=e;t[s]={code:btoa(F(i)),json:JSON.parse(r),poly:a}})),t}static stringifyDSPFactories(){return JSON.stringify(this.serializeDSPFactories())}static deserializeDSPFactories(t){const e=[];for(const s in t){const i=t[s],{code:r,json:a,poly:n}=i,o=N(atob(r));e.push(WebAssembly.compile(o).then((t=>this.gFactories.set(s,{shaKey:s,cfactory:0,code:o,module:t,json:JSON.stringify(a),poly:n}))))}return Promise.all(e)}static importDSPFactories(t){const e=JSON.parse(t);return this.deserializeDSPFactories(e)}constructor(t){this.fLibFaust=t,this.fErrorMessage=""}intVec2intArray(t){const e=t.size(),s=new Uint8Array(e);for(let i=0;i<e;i++)s[i]=t.get(i);return s}async createDSPFactory(t,e,s,i){_.gFactories.size>10&&_.gFactories.clear();let r=await(async t=>{const e=new A.Sha256;return e.update(t),Array.from(await e.digest()).map((t=>t.toString(16).padStart(2,"0"))).join("")})(t+e+s+(i?"poly":"mono"));if(_.gFactories.has(r))return _.gFactories.get(r)||null;try{const a=this.fLibFaust.createDSPFactory(t,e,s,!i),n=this.intVec2intArray(a.data);a.data.delete();const o=await WebAssembly.compile(n),f={shaKey:r,cfactory:a.cfactory,code:n,module:o,json:a.json,poly:i};return this.deleteDSPFactory(f),_.gFactories.set(r,f),f}catch(t){throw this.fErrorMessage=this.fLibFaust.getErrorAfterException(),this.fLibFaust.cleanupAfterException(),this.fErrorMessage?new Error(this.fErrorMessage):t}}version(){return this.fLibFaust.version()}getErrorMessage(){return this.fErrorMessage}async createMonoDSPFactory(t,e,s){return this.createDSPFactory(t,e,s,!1)}async createPolyDSPFactory(t,e,s){return this.createDSPFactory(t,e,s,!0)}deleteDSPFactory(t){this.fLibFaust.deleteDSPFactory(t.cfactory),t.cfactory=0}expandDSP(t,e){try{return this.fLibFaust.expandDSP("FaustDSP",t,e)}catch(t){throw this.fErrorMessage=this.fLibFaust.getErrorAfterException(),this.fLibFaust.cleanupAfterException(),this.fErrorMessage?new Error(this.fErrorMessage):t}}generateAuxFiles(t,e,s){try{return this.fLibFaust.generateAuxFiles(t,e,s)}catch(t){throw this.fErrorMessage=this.fLibFaust.getErrorAfterException(),this.fLibFaust.cleanupAfterException(),this.fErrorMessage?new Error(this.fErrorMessage):t}}deleteAllDSPFactories(){this.fLibFaust.deleteAllDSPFactories()}fs(){return this.fLibFaust.fs()}async getAsyncInternalMixerModule(t=!1){const e=t?"mixer64Buffer":"mixer32Buffer",s=t?"mixer64Module":"mixer32Module";if(this[s])return{mixerBuffer:this[e],mixerModule:this[s]};const i=t?"/usr/rsrc/mixer64.wasm":"/usr/rsrc/mixer32.wasm",r=this.fs().readFile(i,{encoding:"binary"});this[e]=r;const a=await WebAssembly.compile(r);return this[s]=a,{mixerBuffer:r,mixerModule:a}}getSyncInternalMixerModule(t=!1){const e=t?"mixer64Buffer":"mixer32Buffer",s=t?"mixer64Module":"mixer32Module";if(this[s])return{mixerBuffer:this[e],mixerModule:this[s]};const i=t?"/usr/rsrc/mixer64.wasm":"/usr/rsrc/mixer32.wasm",r=this.fs().readFile(i,{encoding:"binary"});this[e]=r;const a=new WebAssembly.Module(r);return this[s]=a,{mixerBuffer:r,mixerModule:a}}},x=_;x.gFactories=new Map;var V=x,E=class{constructor(t){this.fExports=t}compute(t,e,s,i){this.fExports.compute(t,e,s,i)}getNumInputs(t){return this.fExports.getNumInputs(t)}getNumOutputs(t){return this.fExports.getNumOutputs(t)}getParamValue(t,e){return this.fExports.getParamValue(t,e)}getSampleRate(t){return this.fExports.getSampleRate(t)}init(t,e){this.fExports.init(t,e)}instanceClear(t){this.fExports.instanceClear(t)}instanceConstants(t,e){this.fExports.instanceConstants(t,e)}instanceInit(t,e){this.fExports.instanceInit(t,e)}instanceResetUserInterface(t){this.fExports.instanceResetUserInterface(t)}setParamValue(t,e,s){this.fExports.setParamValue(t,e,s)}},k=class{static createWasmImport(t){return{env:{memory:t||new WebAssembly.Memory({initial:100}),memoryBase:0,tableBase:0,_abs:Math.abs,_acosf:Math.acos,_asinf:Math.asin,_atanf:Math.atan,_atan2f:Math.atan2,_ceilf:Math.ceil,_cosf:Math.cos,_expf:Math.exp,_floorf:Math.floor,_fmodf:(t,e)=>t%e,_logf:Math.log,_log10f:Math.log10,_max_f:Math.max,_min_f:Math.min,_remainderf:(t,e)=>t-Math.round(t/e)*e,_powf:Math.pow,_roundf:Math.round,_sinf:Math.sin,_sqrtf:Math.sqrt,_tanf:Math.tan,_acoshf:Math.acosh,_asinhf:Math.asinh,_atanhf:Math.atanh,_coshf:Math.cosh,_sinhf:Math.sinh,_tanhf:Math.tanh,_isnanf:Number.isNaN,_isinff:t=>!isFinite(t),_copysignf:(t,e)=>Math.sign(t)===Math.sign(e)?t:-t,_acos:Math.acos,_asin:Math.asin,_atan:Math.atan,_atan2:Math.atan2,_ceil:Math.ceil,_cos:Math.cos,_exp:Math.exp,_floor:Math.floor,_fmod:(t,e)=>t%e,_log:Math.log,_log10:Math.log10,_max_:Math.max,_min_:Math.min,_remainder:(t,e)=>t-Math.round(t/e)*e,_pow:Math.pow,_round:Math.round,_sin:Math.sin,_sqrt:Math.sqrt,_tan:Math.tan,_acosh:Math.acosh,_asinh:Math.asinh,_atanh:Math.atanh,_cosh:Math.cosh,_sinh:Math.sinh,_tanh:Math.tanh,_isnan:Number.isNaN,_isinf:t=>!isFinite(t),_copysign:(t,e)=>Math.sign(t)===Math.sign(e)?t:-t,table:new WebAssembly.Table({initial:0,element:"anyfunc"})}}}static createWasmMemory(t,e,s,i,r){const a=Math.max(4,t),n=e;let o=(t=>{let e=65536;for(;e<t;)e*=2;return e})((i?i.size:0)+s.size*a+(s.inputs+2*s.outputs)*(n+r*e))/65536;return o=Math.max(2,o),new WebAssembly.Memory({initial:o,maximum:o})}static createMonoDSPInstanceAux(t,e){const s=t.exports,i=new E(s);return{memory:t.exports.memory,api:i,json:e}}static createMemoryAux(t,e,s){const i=JSON.parse(e.json),r=s&&s.json?JSON.parse(s.json):null,a=i.compile_options.match("-double")?8:4;return this.createWasmMemory(t,a,i,r,8192)}static createMixerAux(t,e){const s={imports:{print:console.log},memory:{memory:e}};return new WebAssembly.Instance(t,s).exports}static async loadDSPFactory(t,e){const s=await fetch(t);if(!s.ok)throw new Error(`=> exception raised while running loadDSPFactory, file not found: ${t}`);try{const t=await s.arrayBuffer(),i=await WebAssembly.compile(t),r=await fetch(e),a=await r.text(),n=-1!==JSON.parse(a).compile_options.indexOf("wasm-e");return{cfactory:0,code:new Uint8Array(t),module:i,json:a,poly:n}}catch(t){throw t}}static async loadDSPMixer(t,e){try{let s=null;if(e)s=e.readFile(t,{encoding:"binary"});else{const e=await fetch(t);s=await e.arrayBuffer()}return WebAssembly.compile(s)}catch(t){throw t}}static async createAsyncMonoDSPInstance(t){const e=await WebAssembly.instantiate(t.module,this.createWasmImport());return this.createMonoDSPInstanceAux(e,t.json)}static createSyncMonoDSPInstance(t){const e=new WebAssembly.Instance(t.module,this.createWasmImport());return this.createMonoDSPInstanceAux(e,t.json)}static async createAsyncPolyDSPInstance(t,e,s,i){const r=this.createMemoryAux(s,t,i),a=(await WebAssembly.instantiate(t.module,this.createWasmImport(r))).exports,n=new E(a),o=this.createMixerAux(e,r);if(i){const e=(await WebAssembly.instantiate(i.module,this.createWasmImport(r))).exports;return{memory:r,voices:s,voiceAPI:n,effectAPI:new E(e),mixerAPI:o,voiceJSON:t.json,effectJSON:i.json}}return{memory:r,voices:s,voiceAPI:n,mixerAPI:o,voiceJSON:t.json}}static createSyncPolyDSPInstance(t,e,s,i){const r=this.createMemoryAux(s,t,i),a=new WebAssembly.Instance(t.module,this.createWasmImport(r)).exports,n=new E(a),o=this.createMixerAux(e,r);if(i){const e=new WebAssembly.Instance(i.module,this.createWasmImport(r)).exports;return{memory:r,voices:s,voiceAPI:n,effectAPI:new E(e),mixerAPI:o,voiceJSON:t.json,effectJSON:i.json}}return{memory:r,voices:s,voiceAPI:n,mixerAPI:o,voiceJSON:t.json}}},z=class{constructor(t,e){this.fOutputHandler=null,this.fComputeHandler=null,this.fCachedEvents=[],this.fBufferNum=0,this.fPlotHandler=null,this.fBufferSize=e,this.fInChannels=[],this.fOutChannels=[],this.gPtrSize=t,this.gSampleSize=t,this.fOutputsTimer=5,this.fInputsItems=[],this.fOutputsItems=[],this.fDescriptor=[],this.fPitchwheelLabel=[],this.fCtrlLabel=new Array(128).fill(null).map((()=>[])),this.fPathTable={},this.fProcessing=!1,this.fDestroyed=!1,this.fUICallback=t=>{if("hbargraph"===t.type||"vbargraph"===t.type)this.fOutputsItems.push(t.address),this.fPathTable[t.address]=t.index;else if("vslider"===t.type||"hslider"===t.type||"button"===t.type||"checkbox"===t.type||"nentry"===t.type){if(this.fInputsItems.push(t.address),this.fPathTable[t.address]=t.index,this.fDescriptor.push(t),!t.meta)return;t.meta.forEach((e=>{const{midi:s}=e;if(!s)return;const i=s.trim();if("pitchwheel"===i)this.fPitchwheelLabel.push({path:t.address,min:t.min,max:t.max});else{const e=i.match(/^ctrl\s(\d+)/);if(!e)return;this.fCtrlLabel[parseInt(e[1])].push({path:t.address,min:t.min,max:t.max})}}))}}}static remap(t,e,s,i,r){return(t-e)/(s-e)*(r-i)+i}static parseUI(t,e){t.forEach((t=>this.parseGroup(t,e)))}static parseGroup(t,e){t.items&&this.parseItems(t.items,e)}static parseItems(t,e){t.forEach((t=>this.parseItem(t,e)))}static parseItem(t,e){"vgroup"===t.type||"hgroup"===t.type||"tgroup"===t.type?this.parseItems(t.items,e):e(t)}updateOutputs(){this.fOutputsItems.length>0&&this.fOutputHandler&&0==this.fOutputsTimer--&&(this.fOutputsTimer=5,this.fOutputsItems.forEach((t=>{var e;return null==(e=this.fOutputHandler)?void 0:e.call(this,t,this.getParamValue(t))})))}metadata(t){this.fJSONDsp.meta&&this.fJSONDsp.meta.forEach((e=>t(Object.keys(e)[0],e[Object.keys(e)[0]])))}compute(t,e){return!1}setOutputParamHandler(t){this.fOutputHandler=t}getOutputParamHandler(){return this.fOutputHandler}setComputeHandler(t){this.fComputeHandler=t}getComputeHandler(){return this.fComputeHandler}setPlotHandler(t){this.fPlotHandler=t}getPlotHandler(){return this.fPlotHandler}getNumInputs(){return-1}getNumOutputs(){return-1}midiMessage(t){this.fPlotHandler&&this.fCachedEvents.push({data:t,type:"midi"});const e=t[0]>>4,s=15&t[0],i=t[1],r=t[2];return 11===e?this.ctrlChange(s,i,r):14===e?this.pitchWheel(s,128*r+i):void 0}ctrlChange(t,e,s){this.fPlotHandler&&this.fCachedEvents.push({type:"ctrlChange",data:[t,e,s]}),this.fCtrlLabel[e].length&&this.fCtrlLabel[e].forEach((t=>{const{path:e}=t;this.setParamValue(e,z.remap(s,0,127,t.min,t.max)),this.fOutputHandler&&this.fOutputHandler(e,this.getParamValue(e))}))}pitchWheel(t,e){this.fPlotHandler&&this.fCachedEvents.push({type:"pitchWheel",data:[t,e]}),this.fPitchwheelLabel.forEach((t=>{this.setParamValue(t.path,z.remap(e,0,16383,t.min,t.max)),this.fOutputHandler&&this.fOutputHandler(t.path,this.getParamValue(t.path))}))}setParamValue(t,e){}getParamValue(t){return 0}getParams(){return this.fInputsItems}getMeta(){return this.fJSONDsp}getJSON(){return JSON.stringify(this.getMeta())}getUI(){return this.fJSONDsp.ui}getDescriptors(){return this.fDescriptor}start(){this.fProcessing=!0}stop(){this.fProcessing=!1}destroy(){this.fDestroyed=!0,this.fOutputHandler=null,this.fComputeHandler=null,this.fPlotHandler=null}},T=class extends z{constructor(t,e,s,i){super(s,i),this.fInstance=t,this.fJSONDsp=JSON.parse(this.fInstance.json),z.parseUI(this.fJSONDsp.ui,this.fUICallback),this.initMemory(),this.fInstance.api.init(this.fDSP,e)}initMemory(){this.fDSP=0;const t=this.fJSONDsp.size;this.fAudioInputs=t,this.fAudioOutputs=this.fAudioInputs+this.getNumInputs()*this.gPtrSize;const e=this.fAudioOutputs+this.getNumOutputs()*this.gPtrSize,s=e+this.getNumInputs()*this.fBufferSize*this.gSampleSize,i=this.fInstance.memory.buffer,r=new Int32Array(i),a=4===this.gSampleSize?new Float32Array(i):new Float64Array(i);if(this.getNumInputs()>0){for(let t=0;t<this.getNumInputs();t++)r[(this.fAudioInputs>>2)+t]=e+this.fBufferSize*this.gSampleSize*t;const t=r.subarray(this.fAudioInputs>>2,this.fAudioInputs+this.getNumInputs()*this.gPtrSize>>2);for(let e=0;e<this.getNumInputs();e++)this.fInChannels[e]=a.subarray(t[e]>>Math.log2(this.gSampleSize),t[e]+this.fBufferSize*this.gSampleSize>>Math.log2(this.gSampleSize))}if(this.getNumOutputs()>0){for(let t=0;t<this.getNumOutputs();t++)r[(this.fAudioOutputs>>2)+t]=s+this.fBufferSize*this.gSampleSize*t;const t=r.subarray(this.fAudioOutputs>>2,this.fAudioOutputs+this.getNumOutputs()*this.gPtrSize>>2);for(let e=0;e<this.getNumOutputs();e++)this.fOutChannels[e]=a.subarray(t[e]>>Math.log2(this.gSampleSize),t[e]+this.fBufferSize*this.gSampleSize>>Math.log2(this.gSampleSize))}}toString(){return`============== Mono Memory layout ==============\nthis.fBufferSize: ${this.fBufferSize}\nthis.fJSONDsp.size: ${this.fJSONDsp.size}\nthis.fAudioInputs: ${this.fAudioInputs}\nthis.fAudioOutputs: ${this.fAudioOutputs}\nthis.fDSP: ${this.fDSP}`}compute(t,e){if(this.fDestroyed)return!1;if(!this.fProcessing)return!0;if("function"==typeof t)t(this.fInChannels);else{if(this.getNumInputs()>0&&(!t||!t[0]||0===t[0].length))return!0;if(this.getNumOutputs()>0&&"function"!=typeof e&&(!e||!e[0]||0===e[0].length))return!0;if(void 0!==t)for(let e=0;e<Math.min(this.getNumInputs(),t.length);e++)this.fInChannels[e].set(t[e])}this.fComputeHandler&&this.fComputeHandler(this.fBufferSize),this.fInstance.api.compute(this.fDSP,this.fBufferSize,this.fAudioInputs,this.fAudioOutputs),this.updateOutputs();let s=this.fOutChannels;if("function"==typeof e)e(this.fOutChannels);else{for(let t=0;t<Math.min(this.getNumOutputs(),e.length);t++){const s=this.fOutChannels[t];e[t].set(s)}s=e}return this.fPlotHandler&&(this.fPlotHandler(s,this.fBufferNum++,this.fCachedEvents.length?this.fCachedEvents:void 0),this.fCachedEvents=[]),!0}metadata(t){super.metadata(t)}getNumInputs(){return this.fInstance.api.getNumInputs(this.fDSP)}getNumOutputs(){return this.fInstance.api.getNumOutputs(this.fDSP)}setParamValue(t,e){this.fPlotHandler&&this.fCachedEvents.push({type:"param",data:{path:t,value:e}}),this.fInstance.api.setParamValue(this.fDSP,this.fPathTable[t],e)}getParamValue(t){return this.fInstance.api.getParamValue(this.fDSP,this.fPathTable[t])}getMeta(){return this.fJSONDsp}getJSON(){return this.fInstance.json}getDescriptors(){return this.fDescriptor}getUI(){return this.fJSONDsp.ui}},j=class{constructor(t,e,s,i,r){j.kActiveVoice=0,j.kFreeVoice=-1,j.kReleaseVoice=-2,j.kLegatoVoice=-3,j.kNoVoice=-4,j.VOICE_STOP_LEVEL=5e-4,this.fCurNote=j.kFreeVoice,this.fNextNote=this.fNextVel=-1,this.fLevel=0,this.fDate=this.fRelease=0,this.fDSP=t,this.fAPI=e,this.fGateLabel=[],this.fGainLabel=[],this.fFreqLabel=[],this.fKeyLabel=[],this.fVelLabel=[],this.fAPI.init(this.fDSP,r),this.extractPaths(s,i)}static midiToFreq(t){return 440*2**((t-69)/12)}static normalizeVelocity(t){return t/127}extractPaths(t,e){t.forEach((t=>{t.endsWith("/gate")?this.fGateLabel.push(e[t]):t.endsWith("/freq")?this.fFreqLabel.push(e[t]):t.endsWith("/key")?this.fKeyLabel.push(e[t]):t.endsWith("/gain")?this.fGainLabel.push(e[t]):t.endsWith("/vel")&&t.endsWith("/velocity")&&this.fVelLabel.push(e[t])}))}keyOn(t,e,s=!1){s?(this.fNextNote=t,this.fNextVel=e):(this.fFreqLabel.forEach((e=>this.fAPI.setParamValue(this.fDSP,e,j.midiToFreq(t)))),this.fGateLabel.forEach((t=>this.fAPI.setParamValue(this.fDSP,t,1))),this.fGainLabel.forEach((t=>this.fAPI.setParamValue(this.fDSP,t,j.normalizeVelocity(e)))),this.fKeyLabel.forEach((e=>this.fAPI.setParamValue(this.fDSP,e,t))),this.fVelLabel.forEach((t=>this.fAPI.setParamValue(this.fDSP,t,e))),this.fCurNote=t)}keyOff(t=!1){this.fGateLabel.forEach((t=>this.fAPI.setParamValue(this.fDSP,t,0))),t?this.fCurNote=j.kFreeVoice:(this.fRelease=this.fAPI.getSampleRate(this.fDSP)/2,this.fCurNote=j.kReleaseVoice)}computeLegato(t,e,s,i){let r=t/2;this.fGateLabel.forEach((t=>this.fAPI.setParamValue(this.fDSP,t,0))),this.fAPI.compute(this.fDSP,r,e,s),this.keyOn(this.fNextNote,this.fNextVel),this.fAPI.compute(this.fDSP,r,e,i)}compute(t,e,s){this.fAPI.compute(this.fDSP,t,e,s)}setParamValue(t,e){this.fAPI.setParamValue(this.fDSP,t,e)}getParamValue(t){return this.fAPI.getParamValue(this.fDSP,t)}},W=class extends z{constructor(t,e,s,i){super(s,i),this.fInstance=t,this.fJSONDsp=JSON.parse(this.fInstance.voiceJSON),this.fJSONEffect=this.fInstance.effectAPI&&this.fInstance.effectJSON?JSON.parse(this.fInstance.effectJSON):null,z.parseUI(this.fJSONDsp.ui,this.fUICallback),this.fJSONEffect&&z.parseUI(this.fJSONEffect.ui,this.fUICallback),this.initMemory(),this.fVoiceTable=[];for(let t=0;t<this.fInstance.voices;t++)this.fVoiceTable.push(new j(this.fJSONDsp.size*t,this.fInstance.voiceAPI,this.fInputsItems,this.fPathTable,e));this.fInstance.effectAPI&&this.fInstance.effectAPI.init(this.fEffect,e)}initMemory(){this.fEffect=this.fJSONDsp.size*this.fInstance.voices;const t=this.fEffect+(this.fJSONEffect?this.fJSONEffect.size:0);this.fAudioInputs=t,this.fAudioOutputs=this.fAudioInputs+this.getNumInputs()*this.gPtrSize,this.fAudioMixing=this.fAudioOutputs+this.getNumOutputs()*this.gPtrSize,this.fAudioMixingHalf=this.fAudioMixing+this.getNumOutputs()*this.gPtrSize;const e=this.fAudioMixingHalf+this.getNumOutputs()*this.gPtrSize,s=e+this.getNumInputs()*this.fBufferSize*this.gSampleSize,i=s+this.getNumOutputs()*this.fBufferSize*this.gSampleSize,r=this.fInstance.memory.buffer,a=new Int32Array(r),n=4===this.gSampleSize?new Float32Array(r):new Float64Array(r);if(this.getNumInputs()>0){for(let t=0;t<this.getNumInputs();t++)a[(this.fAudioInputs>>2)+t]=e+this.fBufferSize*this.gSampleSize*t;const t=a.subarray(this.fAudioInputs>>2,this.fAudioInputs+this.getNumInputs()*this.gPtrSize>>2);for(let e=0;e<this.getNumInputs();e++)this.fInChannels[e]=n.subarray(t[e]>>Math.log2(this.gSampleSize),t[e]+this.fBufferSize*this.gSampleSize>>Math.log2(this.gSampleSize))}if(this.getNumOutputs()>0){for(let t=0;t<this.getNumOutputs();t++)a[(this.fAudioOutputs>>2)+t]=s+this.fBufferSize*this.gSampleSize*t,a[(this.fAudioMixing>>2)+t]=i+this.fBufferSize*this.gSampleSize*t,a[(this.fAudioMixingHalf>>2)+t]=i+this.fBufferSize*this.gSampleSize*t+this.fBufferSize/2*this.gSampleSize;const t=a.subarray(this.fAudioOutputs>>2,this.fAudioOutputs+this.getNumOutputs()*this.gPtrSize>>2);for(let e=0;e<this.getNumOutputs();e++)this.fOutChannels[e]=n.subarray(t[e]>>Math.log2(this.gSampleSize),t[e]+this.fBufferSize*this.gSampleSize>>Math.log2(this.gSampleSize))}}toString(){return`============== Poly Memory layout ==============\nthis.fBufferSize: ${this.fBufferSize}\nthis.fJSONDsp.size: ${this.fJSONDsp.size}\nthis.fAudioInputs: ${this.fAudioInputs}\nthis.fAudioOutputs: ${this.fAudioOutputs}\nthis.fAudioMixing: ${this.fAudioMixing}\nthis.fAudioMixingHalf: ${this.fAudioMixingHalf}`}allocVoice(t,e){return this.fVoiceTable[t].fDate++,this.fVoiceTable[t].fCurNote=e,t}getPlayingVoice(t){let e=j.kNoVoice,s=Number.MAX_VALUE;for(let i=0;i<this.fInstance.voices;i++)this.fVoiceTable[i].fCurNote===t&&this.fVoiceTable[i].fDate<s&&(s=this.fVoiceTable[i].fDate,e=i);return e}getFreeVoice(){for(let t=0;t<this.fInstance.voices;t++)if(this.fVoiceTable[t].fCurNote===j.kFreeVoice)return this.allocVoice(t,j.kActiveVoice);let t=j.kNoVoice,e=j.kNoVoice,s=Number.MAX_VALUE,i=Number.MAX_VALUE;for(let r=0;r<this.fInstance.voices;r++)this.fVoiceTable[r].fCurNote===j.kReleaseVoice?this.fVoiceTable[r].fDate<s&&(s=this.fVoiceTable[r].fDate,t=r):this.fVoiceTable[r].fDate<i&&(i=this.fVoiceTable[r].fDate,e=r);return s!==Number.MAX_VALUE?(console.log(`Steal release voice : voice_date = ${this.fVoiceTable[t].fDate} voice = ${t}`),this.allocVoice(t,j.kLegatoVoice)):i!==Number.MAX_VALUE?(console.log(`Steal playing voice : voice_date = ${this.fVoiceTable[e].fDate} voice = ${e}`),this.allocVoice(e,j.kLegatoVoice)):j.kNoVoice}compute(t,e){if(this.fDestroyed)return!1;if(!this.fProcessing)return!0;if(this.getNumInputs()>0&&(!t||!t[0]||0===t[0].length))return!0;if(this.getNumOutputs()>0&&(!e||!e[0]||0===e[0].length))return!0;if(void 0!==t)for(let e=0;e<Math.min(this.getNumInputs(),t.length);++e)this.fInChannels[e].set(t[e]);if(this.fComputeHandler&&this.fComputeHandler(this.fBufferSize),this.fInstance.mixerAPI.clearOutput(this.fBufferSize,this.getNumOutputs(),this.fAudioOutputs),this.fVoiceTable.forEach((t=>{t.fCurNote===j.kLegatoVoice?(t.computeLegato(this.fBufferSize,this.fAudioInputs,this.fAudioMixing,this.fAudioMixingHalf),this.fInstance.mixerAPI.fadeOut(this.fBufferSize/2,this.getNumOutputs(),this.fAudioMixing),t.fLevel=this.fInstance.mixerAPI.mixCheckVoice(this.fBufferSize,this.getNumOutputs(),this.fAudioMixing,this.fAudioOutputs)):t.fCurNote!==j.kFreeVoice&&(t.compute(this.fBufferSize,this.fAudioInputs,this.fAudioMixing),t.fLevel=this.fInstance.mixerAPI.mixCheckVoice(this.fBufferSize,this.getNumOutputs(),this.fAudioMixing,this.fAudioOutputs),t.fRelease-=this.fBufferSize,t.fCurNote==j.kReleaseVoice&&t.fLevel<j.VOICE_STOP_LEVEL&&t.fRelease<0&&(t.fCurNote=j.kFreeVoice))})),this.fInstance.effectAPI&&this.fInstance.effectAPI.compute(this.fEffect,this.fBufferSize,this.fAudioOutputs,this.fAudioOutputs),this.updateOutputs(),void 0!==e){for(let t=0;t<Math.min(this.getNumOutputs(),e.length);t++){const s=this.fOutChannels[t];e[t].set(s)}this.fPlotHandler&&(this.fPlotHandler(e,this.fBufferNum++,this.fCachedEvents.length?this.fCachedEvents:void 0),this.fCachedEvents=[])}return!0}getNumInputs(){return this.fInstance.voiceAPI.getNumInputs(0)}getNumOutputs(){return this.fInstance.voiceAPI.getNumOutputs(0)}static findPath(t,e){if("object"!=typeof t)return!1;if(t.address)return t.address===e;for(const s in t)if(W.findPath(t[s],e))return!0;return!1}setParamValue(t,e){this.fPlotHandler&&this.fCachedEvents.push({type:"param",data:{path:t,value:e}}),this.fJSONEffect&&W.findPath(this.fJSONEffect.ui,t)&&this.fInstance.effectAPI?this.fInstance.effectAPI.setParamValue(this.fEffect,this.fPathTable[t],e):this.fVoiceTable.forEach((s=>s.setParamValue(this.fPathTable[t],e)))}getParamValue(t){return this.fJSONEffect&&W.findPath(this.fJSONEffect.ui,t)&&this.fInstance.effectAPI?this.fInstance.effectAPI.getParamValue(this.fEffect,this.fPathTable[t]):this.fVoiceTable[0].getParamValue(this.fPathTable[t])}getMeta(){const t=this.fJSONDsp,e=this.fJSONEffect,s={...t};return s.ui=e?[{type:"tgroup",label:"Sequencer",items:[{type:"vgroup",label:"Instrument",items:t.ui},{type:"vgroup",label:"Effect",items:e.ui}]}]:[{type:"tgroup",label:"Polyphonic",items:[{type:"vgroup",label:"Voices",items:t.ui}]}],s}getJSON(){return JSON.stringify(this.getMeta())}getUI(){return this.getMeta().ui}getDescriptors(){return this.fDescriptor}midiMessage(t){const e=t[0]>>4,s=15&t[0],i=t[1],r=t[2];return 8===e||9===e&&0===r?this.keyOff(s,i,r):9===e?this.keyOn(s,i,r):void super.midiMessage(t)}ctrlChange(t,e,s){123===e||120===e?this.allNotesOff(!0):super.ctrlChange(t,e,s)}keyOn(t,e,s){this.fPlotHandler&&this.fCachedEvents.push({type:"keyOn",data:[t,e,s]});const i=this.getFreeVoice();this.fVoiceTable[i].keyOn(e,s,this.fVoiceTable[i].fCurNote==j.kLegatoVoice)}keyOff(t,e,s){this.fPlotHandler&&this.fCachedEvents.push({type:"keyOff",data:[t,e,s]});const i=this.getPlayingVoice(e);i!==j.kNoVoice?this.fVoiceTable[i].keyOff():console.log("Playing pitch = %d not found\n",e)}allNotesOff(t=!0){this.fCachedEvents.push({type:"ctrlChange",data:[0,123,0]}),this.fVoiceTable.forEach((e=>e.keyOff(t)))}},H=class{constructor(t,e){this.fDSPCode=t,this.fBufferSize=e,this.fInputs=new Array(this.fDSPCode.getNumInputs()).fill(null).map((()=>new Float32Array(e))),this.fOutputs=new Array(this.fDSPCode.getNumOutputs()).fill(null).map((()=>new Float32Array(e)))}getParameterDescriptors(){const t=[];return z.parseUI(this.fDSPCode.getUI(),(e=>{let s=null;const i="address"in e&&!!["/gate","/freq","/gain","/key","/vel","/velocity"].find((t=>e.address.endsWith(t)));(this.fDSPCode instanceof T||!i)&&("vslider"===e.type||"hslider"===e.type||"nentry"===e.type?s={name:e.address,defaultValue:e.init||0,minValue:e.min||0,maxValue:e.max||0}:"button"!==e.type&&"checkbox"!==e.type||(s={name:e.address,defaultValue:e.init||0,minValue:0,maxValue:1})),s&&t.push(s)})),t}compute(t,e){return this.fDSPCode.compute(t,e)}setOutputParamHandler(t){this.fDSPCode.setOutputParamHandler(t)}getOutputParamHandler(){return this.fDSPCode.getOutputParamHandler()}setComputeHandler(t){this.fDSPCode.setComputeHandler(t)}getComputeHandler(){return this.fDSPCode.getComputeHandler()}setPlotHandler(t){this.fDSPCode.setPlotHandler(t)}getPlotHandler(){return this.fDSPCode.getPlotHandler()}getNumInputs(){return this.fDSPCode.getNumInputs()}getNumOutputs(){return this.fDSPCode.getNumOutputs()}metadata(t){}midiMessage(t){this.fDSPCode.midiMessage(t)}ctrlChange(t,e,s){this.fDSPCode.ctrlChange(t,e,s)}pitchWheel(t,e){this.fDSPCode.pitchWheel(t,e)}setParamValue(t,e){this.fDSPCode.setParamValue(t,e)}getParamValue(t){return this.fDSPCode.getParamValue(t)}getParams(){return this.fDSPCode.getParams()}getMeta(){return this.fDSPCode.getMeta()}getJSON(){return this.fDSPCode.getJSON()}getDescriptors(){return this.fDSPCode.getDescriptors()}getUI(){return this.fDSPCode.getUI()}start(){this.fDSPCode.start()}stop(){this.fDSPCode.stop()}destroy(){this.fDSPCode.destroy()}render(t=[],e=this.fBufferSize,s){let i=0;const r=new Array(this.fDSPCode.getNumOutputs()).fill(null).map((()=>new Float32Array(e)));for(this.fDSPCode.start();i<e;){const a=Math.min(e-i,this.fBufferSize);for(let e=0;e<this.fDSPCode.getNumInputs();e++){let s;s=t[e]?t[e].length<=i?new Float32Array(a):t[e].length>i+a?t[e].subarray(i,i+a):t[e].subarray(i,t[e].length):new Float32Array(a),this.fInputs[e]=s}this.fDSPCode.compute(this.fInputs,this.fOutputs);for(let t=0;t<this.fDSPCode.getNumOutputs();t++){const e=this.fOutputs[t];a<this.fBufferSize?r[t].set(e.subarray(0,a),i):r[t].set(e,i)}i+=this.fBufferSize,null==s||s(i)}return this.fDSPCode.stop(),r}},B=class extends H{},U=class extends H{keyOn(t,e,s){this.fDSPCode.keyOn(t,e,s)}keyOff(t,e,s){this.fDSPCode.keyOff(t,e,s)}allNotesOff(t){this.fDSPCode.allNotesOff(t)}},L=H,$=class{constructor(t){this.compiler=t}from(t,e,s){const i=this.compiler.fs();try{i.readdir(`/${t}-svg/`).filter((t=>"."!==t&&".."!==t)).forEach((e=>i.unlink(`/${t}-svg/${e}`)))}catch{}if(!this.compiler.generateAuxFiles(t,e,`-lang wasm -svg ${s}`))throw new Error(this.compiler.getErrorMessage());const r={};return i.readdir(`/${t}-svg/`).filter((t=>"."!==t&&".."!==t)).forEach((e=>r[e]=i.readFile(`/${t}-svg/${e}`,{encoding:"utf8"}))),r}},J=class{constructor(t){this.fModule=t,this.fCompiler=new t.libFaustWasm,this.fFileSystem=this.fModule.FS}module(){return this.fModule}fs(){return this.fFileSystem}version(){return this.fCompiler.version()}createDSPFactory(t,e,s,i){return this.fCompiler.createDSPFactory(t,e,s,i)}deleteDSPFactory(t){return this.fCompiler.deleteDSPFactory(t)}expandDSP(t,e,s){return this.fCompiler.expandDSP(t,e,s)}generateAuxFiles(t,e,s){return this.fCompiler.generateAuxFiles(t,e,s)}deleteAllDSPFactories(){return this.fCompiler.deleteAllDSPFactories()}getErrorAfterException(){return this.fCompiler.getErrorAfterException()}cleanupAfterException(){return this.fCompiler.cleanupAfterException()}getInfos(t){return this.fCompiler.getInfos(t)}toString(){return`LibFaust module: ${this.fModule}, compiler: ${this.fCompiler}`}},R=class{constructor(t){this.pos=0,this.dataView=t}int16(t){this.dataView.setInt16(this.pos,t,!0),this.pos+=2}uint16(t){this.dataView.setUint16(this.pos,t,!0),this.pos+=2}uint32(t){this.dataView.setUint32(this.pos,t,!0),this.pos+=4}string(t){for(let e=0,s=t.length;e<s;e++)this.dataView.setUint8(this.pos++,t.charCodeAt(e))}pcm8(t){let e=t;e=Math.max(-1,Math.min(e,1)),e=255*(.5*e+.5),e=0|Math.round(e),this.dataView.setUint8(this.pos,e),this.pos+=1}pcm8s(t){let e=t;e=Math.round(128*e)+128,e=Math.max(0,Math.min(e,255)),this.dataView.setUint8(this.pos,e),this.pos+=1}pcm16(t){let e=t;e=Math.max(-1,Math.min(e,1)),e=e<0?32768*e:32767*e,e=0|Math.round(e),this.dataView.setInt16(this.pos,e,!0),this.pos+=2}pcm16s(t){let e=t;e=Math.round(32768*e),e=Math.max(-32768,Math.min(e,32767)),this.dataView.setInt16(this.pos,e,!0),this.pos+=2}pcm24(t){let e=t;e=Math.max(-1,Math.min(e,1)),e=e<0?16777216+8388608*e:8388607*e,e=0|Math.round(e);const s=e>>0&255,i=e>>8&255,r=e>>16&255;this.dataView.setUint8(this.pos+0,s),this.dataView.setUint8(this.pos+1,i),this.dataView.setUint8(this.pos+2,r),this.pos+=3}pcm24s(t){let e=t;e=Math.round(8388608*e),e=Math.max(-8388608,Math.min(e,8388607));const s=e>>0&255,i=e>>8&255,r=e>>16&255;this.dataView.setUint8(this.pos+0,s),this.dataView.setUint8(this.pos+1,i),this.dataView.setUint8(this.pos+2,r),this.pos+=3}pcm32(t){let e=t;e=Math.max(-1,Math.min(e,1)),e=e<0?2147483648*e:2147483647*e,e=0|Math.round(e),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}pcm32s(t){let e=t;e=Math.round(2147483648*e),e=Math.max(-2147483648,Math.min(e,2147483647)),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}pcm32f(t){this.dataView.setFloat32(this.pos,t,!0),this.pos+=4}},K=class{static encode(t,e){const s=t.length,i=t[0].length,{shared:r,float:a}=e,n=a?32:0|e.bitDepth||16,o=n>>3,f=i*s*o,u=new(r&&globalThis.SharedArrayBuffer||globalThis.ArrayBuffer)((44+f)*Uint8Array.BYTES_PER_ELEMENT),h=new DataView(u),l=new R(h),c={formatId:a?3:1,float:!!a,numberOfChannels:s,sampleRate:e.sampleRate,symmetric:!!e.symmetric,length:i,bitDepth:n,byteDepth:o};return this.writeHeader(l,c),this.writeData(l,t,c),u}static writeHeader(t,e){const{formatId:s,sampleRate:i,bitDepth:r,numberOfChannels:a,length:n,byteDepth:o}=e;return t.string("RIFF"),t.uint32(t.dataView.byteLength-8),t.string("WAVE"),t.string("fmt "),t.uint32(16),t.uint16(s),t.uint16(a),t.uint32(i),t.uint32(i*a*o),t.uint16(a*o),t.uint16(r),t.string("data"),t.uint32(n*a*o),t.pos}static writeData(t,e,s){const{bitDepth:i,float:r,length:a,numberOfChannels:n,symmetric:o}=s;if(32===i&&r){const{dataView:s,pos:i}=t,r=s.buffer,o=new Float32Array(r,i);if(1===n)return void o.set(e[0]);for(let t=0;t<n;t++){const s=e[t];for(let e=0;e<a;e++)o[e*n+t]=s[e]}return}const f="pcm"+i+(r?"f":o?"s":"");if(!t[f])throw new TypeError("Not supported bit depth: "+i);const u=t[f].bind(t);for(let t=0;t<a;t++)for(let s=0;s<n;s++)u(e[s][t])}},G=class{constructor(t){this.pos=0,this.dataView=t}remain(){return this.dataView.byteLength-this.pos}skip(t){this.pos+=t}uint8(){const t=this.dataView.getUint8(this.pos);return this.pos+=1,t}int16(){const t=this.dataView.getInt16(this.pos,!0);return this.pos+=2,t}uint16(){const t=this.dataView.getUint16(this.pos,!0);return this.pos+=2,t}uint32(){const t=this.dataView.getUint32(this.pos,!0);return this.pos+=4,t}string(t){let e="";for(let s=0;s<t;s++)e+=String.fromCharCode(this.uint8());return e}pcm8(){const t=this.dataView.getUint8(this.pos)-128;return this.pos+=1,t<0?t/128:t/127}pcm8s(){const t=this.dataView.getUint8(this.pos)-127.5;return this.pos+=1,t/127.5}pcm16(){const t=this.dataView.getInt16(this.pos,!0);return this.pos+=2,t<0?t/32768:t/32767}pcm16s(){const t=this.dataView.getInt16(this.pos,!0);return this.pos+=2,t/32768}pcm24(){const t=this.dataView.getUint8(this.pos+0)+(this.dataView.getUint8(this.pos+1)<<8)+(this.dataView.getUint8(this.pos+2)<<16),e=t>8388608?t-16777216:t;return this.pos+=3,e<0?e/8388608:e/8388607}pcm24s(){const t=this.dataView.getUint8(this.pos+0)+(this.dataView.getUint8(this.pos+1)<<8)+(this.dataView.getUint8(this.pos+2)<<16),e=t>8388608?t-16777216:t;return this.pos+=3,e/8388608}pcm32(){const t=this.dataView.getInt32(this.pos,!0);return this.pos+=4,t<0?t/2147483648:t/2147483647}pcm32s(){const t=this.dataView.getInt32(this.pos,!0);return this.pos+=4,t/2147483648}pcm32f(){const t=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,t}pcm64f(){const t=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,t}},q=class{static decode(t,e){const s=new DataView(t),i=new G(s);if("RIFF"!==i.string(4))throw new TypeError("Invalid WAV file");if(i.uint32(),"WAVE"!==i.string(4))throw new TypeError("Invalid WAV file");let r=null,a=null;do{const t=i.string(4),s=i.uint32();"fmt "===t?r=this.decodeFormat(i,s):"data"===t?a=this.decodeData(i,s,r,e||{}):i.skip(s)}while(null===a);return a}static decodeFormat(t,e){const s=t.uint16();if(!{1:"lpcm",3:"lpcm"}.hasOwnProperty(s))throw new TypeError("Unsupported format in WAV file: 0x"+s.toString(16));const i={formatId:s,float:3===s,numberOfChannels:t.uint16(),sampleRate:t.uint32(),byteRate:t.uint32(),blockSize:t.uint16(),bitDepth:t.uint16()};return t.skip(e-16),i}static decodeData(t,e,s,i){const r=Math.min(e,t.remain()),a=Math.floor(r/s.blockSize),n=s.numberOfChannels,o=s.sampleRate,f=new Array(n);for(let t=0;t<n;t++){const e=new(i.shared&&globalThis.SharedArrayBuffer||globalThis.ArrayBuffer)(a*Float32Array.BYTES_PER_ELEMENT);f[t]=new Float32Array(e)}return this.readPCM(t,f,a,s,i),{numberOfChannels:n,length:a,sampleRate:o,channelData:f}}static readPCM(t,e,s,i,r){const a="pcm"+i.bitDepth+(i.float?"f":r.symmetric?"s":"");if(!t[a])throw new TypeError("Not supported bit depth: "+i.bitDepth);const n=t[a].bind(t),o=i.numberOfChannels;for(let t=0;t<s;t++)for(let s=0;s<o;s++)e[s][t]=n()}},Z=class extends(globalThis.AudioWorkletNode||null){constructor(t,e,s,i,r={}){const a=JSON.parse(s.json);super(t,e,{numberOfInputs:a.inputs>0?1:0,numberOfOutputs:a.outputs>0?1:0,channelCount:Math.max(1,a.inputs),outputChannelCount:[a.outputs],channelCountMode:"explicit",channelInterpretation:"speakers",processorOptions:i,...r}),this.fJSONDsp=a,this.fJSON=s.json,this.fOutputHandler=null,this.fComputeHandler=null,this.fPlotHandler=null,this.fDescriptor=[],this.fInputsItems=[],this.fUICallback=t=>{"vslider"!==t.type&&"hslider"!==t.type&&"button"!==t.type&&"checkbox"!==t.type&&"nentry"!==t.type||(this.fInputsItems.push(t.address),this.fDescriptor.push(t))},z.parseUI(this.fJSONDsp.ui,this.fUICallback),this.port.onmessage=t=>{"param"===t.data.type&&this.fOutputHandler?this.fOutputHandler(t.data.path,t.data.value):"plot"===t.data.type&&this.fPlotHandler&&this.fPlotHandler(t.data.value,t.data.index,t.data.events)}}setOutputParamHandler(t){this.fOutputHandler=t}getOutputParamHandler(){return this.fOutputHandler}setComputeHandler(t){this.fComputeHandler=t}getComputeHandler(){return this.fComputeHandler}setPlotHandler(t){this.fPlotHandler=t,this.fPlotHandler?this.port.postMessage({type:"setPlotHandler",data:!0}):this.port.postMessage({type:"setPlotHandler",data:!1})}getPlotHandler(){return this.fPlotHandler}getNumInputs(){return this.fJSONDsp.inputs}getNumOutputs(){return this.fJSONDsp.outputs}compute(t,e){return!1}metadata(t){this.fJSONDsp.meta&&this.fJSONDsp.meta.forEach((e=>t(Object.keys(e)[0],e[Object.keys(e)[0]])))}midiMessage(t){const e=t[0]>>4,s=15&t[0],i=t[1],r=t[2];11===e?this.ctrlChange(s,i,r):14===e?this.pitchWheel(s,128*r+i):this.port.postMessage({type:"midi",data:t})}ctrlChange(t,e,s){const i={type:"ctrlChange",data:[t,e,s]};this.port.postMessage(i)}pitchWheel(t,e){const s={type:"pitchWheel",data:[t,e]};this.port.postMessage(s)}setParamValue(t,e){const s={type:"param",data:{path:t,value:e}};this.port.postMessage(s);const i=this.parameters.get(t);i&&i.setValueAtTime(e,this.context.currentTime)}getParamValue(t){const e=this.parameters.get(t);return e?e.value:0}getParams(){return this.fInputsItems}getMeta(){return this.fJSONDsp}getJSON(){return JSON.stringify(this.getMeta())}getUI(){return this.fJSONDsp.ui}getDescriptors(){return this.fDescriptor}start(){this.port.postMessage({type:"start"})}stop(){this.port.postMessage({type:"stop"})}destroy(){this.port.postMessage({type:"destroy"}),this.port.close()}},X=class extends Z{constructor(t,e,s,i,r={}){super(t,e,s,{name:e,factory:s,sampleSize:i},r),this.onprocessorerror=t=>{throw t}}},Y=class extends Z{constructor(t,e,s,i,r,a,n,o={}){super(t,e,s,{name:e,voiceFactory:s,mixerModule:i,voices:r,sampleSize:a,effectFactory:n},o),this.onprocessorerror=t=>{throw t},this.fJSONEffect=n?JSON.parse(n.json):null,this.fJSONEffect&&z.parseUI(this.fJSONEffect.ui,this.fUICallback)}keyOn(t,e,s){const i={type:"keyOn",data:[t,e,s]};this.port.postMessage(i)}keyOff(t,e,s){const i={type:"keyOff",data:[t,e,s]};this.port.postMessage(i)}allNotesOff(t){this.port.postMessage({type:"ctrlChange",data:[0,123,0]})}getMeta(){const t=this.fJSONDsp,e=this.fJSONEffect,s={...t};return s.ui=e?[{type:"tgroup",label:"Sequencer",items:[{type:"vgroup",label:"Instrument",items:t.ui},{type:"vgroup",label:"Effect",items:e.ui}]}]:[{type:"tgroup",label:"Polyphonic",items:[{type:"vgroup",label:"Voices",items:t.ui}]}],s}getJSON(){return JSON.stringify(this.getMeta())}getUI(){return this.getMeta().ui}},Q=class extends(globalThis.ScriptProcessorNode||null){init(t){this.fDSPCode=t,this.fInputs=new Array(this.fDSPCode.getNumInputs()),this.fOutputs=new Array(this.fDSPCode.getNumOutputs()),this.onaudioprocess=t=>{for(let e=0;e<this.fDSPCode.getNumInputs();e++)this.fInputs[e]=t.inputBuffer.getChannelData(e);for(let e=0;e<this.fDSPCode.getNumOutputs();e++)this.fOutputs[e]=t.outputBuffer.getChannelData(e);return this.fDSPCode.compute(this.fInputs,this.fOutputs)},this.start()}compute(t,e){return this.fDSPCode.compute(t,e)}setOutputParamHandler(t){this.fDSPCode.setOutputParamHandler(t)}getOutputParamHandler(){return this.fDSPCode.getOutputParamHandler()}setComputeHandler(t){this.fDSPCode.setComputeHandler(t)}getComputeHandler(){return this.fDSPCode.getComputeHandler()}setPlotHandler(t){this.fDSPCode.setPlotHandler(t)}getPlotHandler(){return this.fDSPCode.getPlotHandler()}getNumInputs(){return this.fDSPCode.getNumInputs()}getNumOutputs(){return this.fDSPCode.getNumOutputs()}metadata(t){}midiMessage(t){this.fDSPCode.midiMessage(t)}ctrlChange(t,e,s){this.fDSPCode.ctrlChange(t,e,s)}pitchWheel(t,e){this.fDSPCode.pitchWheel(t,e)}setParamValue(t,e){this.fDSPCode.setParamValue(t,e)}getParamValue(t){return this.fDSPCode.getParamValue(t)}getParams(){return this.fDSPCode.getParams()}getMeta(){return this.fDSPCode.getMeta()}getJSON(){return this.fDSPCode.getJSON()}getDescriptors(){return this.fDSPCode.getDescriptors()}getUI(){return this.fDSPCode.getUI()}start(){this.fDSPCode.start()}stop(){this.fDSPCode.stop()}destroy(){this.fDSPCode.destroy()}},tt=class extends Q{},et=class extends Q{keyOn(t,e,s){this.fDSPCode.keyOn(t,e,s)}keyOff(t,e,s){this.fDSPCode.keyOff(t,e,s)}allNotesOff(t){this.fDSPCode.allNotesOff(t)}},st=class{constructor(){this.factory=null}async compile(t,e,s,i){return this.factory=await t.createMonoDSPFactory(e,s,i),this.factory?(this.name=e,this):null}async createNode(t,e=this.name,s=this.factory,i=!1,r=1024,a=(null==s?void 0:s.shaKey)||e){var n,o;if(!s)throw new Error("Code is not compiled, please define the factory or call `await this.compile()` first.");const f=JSON.parse(s.json),u=f.compile_options.match("-double")?8:4;if(i){const e=await k.createAsyncMonoDSPInstance(s),i=new T(e,t.sampleRate,u,r),a=t.createScriptProcessor(r,i.getNumInputs(),i.getNumOutputs());return Object.setPrototypeOf(a,tt.prototype),a.init(i),a}if(st.gWorkletProcessors.has(t)||st.gWorkletProcessors.set(t,new Set),!(null==(n=st.gWorkletProcessors.get(t))?void 0:n.has(a)))try{const s=`\n// DSP name and JSON string for DSP are generated\nconst faustData = ${JSON.stringify({processorName:a,dspName:e,dspMeta:f,poly:!1})};\n// Implementation needed classes of functions\nconst ${E.name} = ${E.toString()}\nconst ${z.name} = ${z.toString()}\nconst ${T.name} = ${T.toString()}\nconst ${k.name} = ${k.toString()}\n// Put them in dependencies\nconst dependencies = {\n    FaustBaseWebAudioDsp: ${z.name},\n    FaustMonoWebAudioDsp: ${T.name},\n    FaustWasmInstantiator: ${k.name}\n};\n// Generate the actual AudioWorkletProcessor code\n(${M.toString()})(dependencies, faustData);\n`,i=URL.createObjectURL(new Blob([s],{type:"text/javascript"}));await t.audioWorklet.addModule(i),null==(o=st.gWorkletProcessors.get(t))||o.add(a)}catch(t){throw t}return new X(t,a,s,u)}async createFFTNode(t,e,s=this.name,i=this.factory,r={},a=((null==i?void 0:i.shaKey)?`${i.shaKey}_fft`:s)){var n,o;if(!i)throw new Error("Code is not compiled, please define the factory or call `await this.compile()` first.");const f=JSON.parse(i.json),u=f.compile_options.match("-double")?8:4;if(st.gWorkletProcessors.has(t)||st.gWorkletProcessors.set(t,new Set),!(null==(n=st.gWorkletProcessors.get(t))?void 0:n.has(a)))try{const i=`\n// DSP name and JSON string for DSP are generated\nconst faustData = ${JSON.stringify({processorName:a,dspName:s,dspMeta:f,fftOptions:r})};\n// Implementation needed classes of functions\nconst ${E.name} = ${E.toString()}\nconst ${z.name} = ${z.toString()}\nconst ${T.name} = ${T.toString()}\nconst ${k.name} = ${k.toString()}\nconst FFTUtils = ${e.toString()}\n// Put them in dependencies\nconst dependencies = {\n    FaustBaseWebAudioDsp: ${z.name},\n    FaustMonoWebAudioDsp: ${T.name},\n    FaustWasmInstantiator: ${k.name},\n    FFTUtils\n};\n// Generate the actual AudioWorkletProcessor code\n(${C.toString()})(dependencies, faustData);\n`,n=URL.createObjectURL(new Blob([i],{type:"text/javascript"}));await t.audioWorklet.addModule(n),null==(o=st.gWorkletProcessors.get(t))||o.add(a)}catch(t){throw t}const h=new X(t,a,i,u,{channelCount:Math.max(1,Math.ceil(f.inputs/3)),outputChannelCount:[Math.ceil(f.outputs/2)]});if(r.fftSize){const t=h.parameters.get("fftSize");t&&(t.value=r.fftSize)}if(r.fftOverlap){const t=h.parameters.get("fftOverlap");t&&(t.value=r.fftOverlap)}if("number"==typeof r.defaultWindowFunction){const t=h.parameters.get("windowFunction");t&&(t.value=r.defaultWindowFunction+1)}if("boolean"==typeof r.noIFFT){const t=h.parameters.get("noIFFT");t&&(t.value=+r.noIFFT)}return h}async createAudioWorkletProcessor(t=this.name,e=this.factory,s=(null==e?void 0:e.shaKey)||t){if(!e)throw new Error("Code is not compiled, please define the factory or call `await this.compile()` first.");const i=JSON.parse(e.json),r={FaustBaseWebAudioDsp:z,FaustMonoWebAudioDsp:T,FaustWasmInstantiator:k,FaustPolyWebAudioDsp:void 0,FaustWebAudioDspVoice:void 0};try{return M(r,{processorName:s,dspName:t,dspMeta:i,poly:!1})}catch(t){throw t}}async createOfflineProcessor(t,e,s=this.factory){if(!s)throw new Error("Code is not compiled, please define the factory or call `await this.compile()` first.");const i=JSON.parse(s.json),r=await k.createAsyncMonoDSPInstance(s),a=i.compile_options.match("-double")?8:4,n=new T(r,t,a,e);return new B(n,e)}getMeta(){return JSON.parse(this.factory.json)}getJSON(){return JSON.stringify(this.getMeta())}getUI(){return this.getMeta().ui}},it=st;it.gWorkletProcessors=new Map;var rt=class{constructor(){this.voiceFactory=null,this.effectFactory=null}async compile(t,e,s,i,r=`\nadapt(1,1) = _; adapt(2,2) = _,_; adapt(1,2) = _ <: _,_; adapt(2,1) = _,_ :> _;\nadaptor(F,G) = adapt(outputs(F),inputs(G));\ndsp_code = environment{${s}};\nprocess = adaptor(dsp_code.process, dsp_code.effect) : dsp_code.effect;`){if(this.voiceFactory=await t.createPolyDSPFactory(e,s,i),!this.voiceFactory)return null;try{this.effectFactory=await t.createPolyDSPFactory(e,r,i)}catch(t){console.warn(t)}this.name=e;const a=JSON.parse(this.voiceFactory.json).compile_options.match("-double"),{mixerBuffer:n,mixerModule:o}=await t.getAsyncInternalMixerModule(!!a);return this.mixerBuffer=n,this.mixerModule=o,this}async createNode(t,e,s=this.name,i=this.voiceFactory,r=this.mixerModule,a=this.effectFactory,n=!1,o=1024,f=((null==i?void 0:i.shaKey)||"")+((null==a?void 0:a.shaKey)||"")||`${s}_poly`){var u,h;if(!i)throw new Error("Code is not compiled, please define the factory or call `await this.compile()` first.");const l=JSON.parse(i.json),c=a?JSON.parse(a.json):void 0,p=l.compile_options.match("-double")?8:4;if(n){const s=await k.createAsyncPolyDSPInstance(i,r,e,a||void 0),n=new W(s,t.sampleRate,p,o),f=t.createScriptProcessor(o,n.getNumInputs(),n.getNumOutputs());return Object.setPrototypeOf(f,et.prototype),f.init(n),f}if(rt.gWorkletProcessors.has(t)||rt.gWorkletProcessors.set(t,new Set),!(null==(u=rt.gWorkletProcessors.get(t))?void 0:u.has(f)))try{const e=`\n// DSP name and JSON string for DSP are generated\nconst faustData = ${JSON.stringify({processorName:f,dspName:s,dspMeta:l,poly:!0,effectMeta:c})};\n// Implementation needed classes of functions\nconst ${E.name} = ${E.toString()}\nconst ${z.name} = ${z.toString()}\nconst ${W.name} = ${W.toString()}\nconst ${j.name} = ${j.toString()}\nconst ${k.name} = ${k.toString()}\n// Put them in dependencies\nconst dependencies = {\n    FaustBaseWebAudioDsp: ${z.name},\n    FaustPolyWebAudioDsp: ${W.name},\n    FaustWasmInstantiator: ${k.name}\n};\n// Generate the actual AudioWorkletProcessor code\n(${M.toString()})(dependencies, faustData);\n`,i=URL.createObjectURL(new Blob([e],{type:"text/javascript"}));await t.audioWorklet.addModule(i),null==(h=rt.gWorkletProcessors.get(t))||h.add(f)}catch(t){throw t}return new Y(t,f,i,r,e,p,a||void 0)}async createAudioWorkletProcessor(t=this.name,e=this.voiceFactory,s=this.effectFactory,i=((null==e?void 0:e.shaKey)||"")+((null==s?void 0:s.shaKey)||"")||`${t}_poly`){if(!e)throw new Error("Code is not compiled, please define the factory or call `await this.compile()` first.");const r=JSON.parse(e.json),a=s?JSON.parse(s.json):void 0;r.compile_options.match("-double");try{return M({FaustBaseWebAudioDsp:z,FaustMonoWebAudioDsp:void 0,FaustWasmInstantiator:k,FaustPolyWebAudioDsp:W,FaustWebAudioDspVoice:j},{processorName:i,dspName:t,dspMeta:r,poly:!0,effectMeta:a})}catch(t){throw t}}async createOfflineProcessor(t,e,s,i=this.voiceFactory,r=this.mixerModule,a=this.effectFactory){if(!i)throw new Error("Code is not compiled, please define the factory or call `await this.compile()` first.");const n=JSON.parse(i.json),o=(a&&JSON.parse(a.json),await k.createAsyncPolyDSPInstance(i,r,s,a||void 0)),f=n.compile_options.match("-double")?8:4,u=new W(o,t,f,e);return new U(u,e)}getMeta(){const t=this.voiceFactory?JSON.parse(this.voiceFactory.json):null,e=this.effectFactory?JSON.parse(this.effectFactory.json):null,s={...t};return s.ui=e?[{type:"tgroup",label:"Sequencer",items:[{type:"vgroup",label:"Instrument",items:t.ui},{type:"vgroup",label:"Effect",items:e.ui}]}]:[{type:"tgroup",label:"Polyphonic",items:[{type:"vgroup",label:"Voices",items:t.ui}]}],s}getJSON(){return JSON.stringify(this.getMeta())}getUI(){return this.getMeta().ui}},at=rt;at.gWorkletProcessors=new Map}},n={};function o(t){var e=n[t];if(void 0!==e)return e.exports;var s=n[t]={id:t,loaded:!1,exports:{}};return a[t].call(s.exports,s,s.exports,o),s.loaded=!0,s.exports}o.m=a,e=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,o.t=function(s,i){if(1&i&&(s=this(s)),8&i)return s;if("object"==typeof s&&s){if(4&i&&s.__esModule)return s;if(16&i&&"function"==typeof s.then)return s}var r=Object.create(null);o.r(r);var a={};t=t||[null,e({}),e([]),e(e)];for(var n=2&i&&s;"object"==typeof n&&!~t.indexOf(n);n=e(n))Object.getOwnPropertyNames(n).forEach((t=>a[t]=()=>s[t]));return a.default=()=>s,o.d(r,a),r},o.d=(t,e)=>{for(var s in e)o.o(e,s)&&!o.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},o.f={},o.e=t=>Promise.all(Object.keys(o.f).reduce(((e,s)=>(o.f[s](t,e),e)),[])),o.u=t=>t+".main.js",o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),s={},i="chord_trainer:",o.l=(t,e,r,a)=>{if(s[t])s[t].push(e);else{var n,f;if(void 0!==r)for(var u=document.getElementsByTagName("script"),h=0;h<u.length;h++){var l=u[h];if(l.getAttribute("src")==t||l.getAttribute("data-webpack")==i+r){n=l;break}}n||(f=!0,(n=document.createElement("script")).charset="utf-8",n.timeout=120,o.nc&&n.setAttribute("nonce",o.nc),n.setAttribute("data-webpack",i+r),n.src=t),s[t]=[e];var c=(e,i)=>{n.onerror=n.onload=null,clearTimeout(p);var r=s[t];if(delete s[t],n.parentNode&&n.parentNode.removeChild(n),r&&r.forEach((t=>t(i))),e)return e(i)},p=setTimeout(c.bind(null,void 0,{type:"timeout",target:n}),12e4);n.onerror=c.bind(null,n.onerror),n.onload=c.bind(null,n.onload),f&&document.head.appendChild(n)}},o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{var t;o.g.importScripts&&(t=o.g.location+"");var e=o.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var s=e.getElementsByTagName("script");if(s.length)for(var i=s.length-1;i>-1&&!t;)t=s[i--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=t})(),(()=>{var t={179:0};o.f.j=(e,s)=>{var i=o.o(t,e)?t[e]:void 0;if(0!==i)if(i)s.push(i[2]);else{var r=new Promise(((s,r)=>i=t[e]=[s,r]));s.push(i[2]=r);var a=o.p+o.u(e),n=new Error;o.l(a,(s=>{if(o.o(t,e)&&(0!==(i=t[e])&&(t[e]=void 0),i)){var r=s&&("load"===s.type?"missing":s.type),a=s&&s.target&&s.target.src;n.message="Loading chunk "+e+" failed.\n("+r+": "+a+")",n.name="ChunkLoadError",n.type=r,n.request=a,i[1](n)}}),"chunk-"+e,e)}};var e=(e,s)=>{var i,r,[a,n,f]=s,u=0;if(a.some((e=>0!==t[e]))){for(i in n)o.o(n,i)&&(o.m[i]=n[i]);f&&f(o)}for(e&&e(s);u<a.length;u++)r=a[u],o.o(t,r)&&t[r]&&t[r][0](),t[r]=0},s=self.webpackChunkchord_trainer=self.webpackChunkchord_trainer||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))})(),(r={})["@grame/faustwasm"]=o(392),o.g.shadow$bridge=function(t){var e=r[t];if(void 0===e)throw new Error("Dependency: "+t+" not provided by external JS. Do you maybe need a recompile?");return e},shadow$bridge.ALL=r})();